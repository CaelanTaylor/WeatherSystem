<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>24 Hour Wind Trend - WindScout</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <div class="navbar">
        <div class="logo">
            <h1>WindScout</h1>
        </div>
        <div class="navitems">
            <ul>
                <li><a href="index.html">LiveWeather</a></li>
                <li><a href="10mtrend.html">10 Minute Trend</a></li>
                <li><a href="1htrend.html">1 Hour Trend</a></li>
                <li><a href="analysis.html">Analysis</a></li>
                <li><a href="settings.html">Settings</a></li>
                <li class="active"><a href="24htrend.html">24 Hour Trend</a></li>
            </ul>
        </div>
    </div>
    <div class="content">
        <div class="title">
            <h1>24 Hour Wind Trend</h1>
            <div class="line"></div>
        </div>
        <div class="dashboard">
            <div>
                <canvas id="avgWindChart" width="800" height="400"></canvas>
            </div>
            <div>
                <canvas id="gustChart" width="800" height="400"></canvas>
            </div>
            <div>
                <canvas id="dirChart" width="800" height="400"></canvas>
            </div>
        </div>
    </div>

    <script>
        function fetchAndDisplayTrend() {
            fetch('http://192.168.192.186:5001/trend24h')
                .then(response => response.json())
                .then(data => {
                    const labels = data.map(item => item.time);
                    const avgWindData = data.map(item => item.avg_wind);
                    const maxGustData = data.map(item => item.max_gust);
                    const dirData = data.map(item => item.avg_dir);

                    const avgWindCtx = document.getElementById('avgWindChart').getContext('2d');
                    const avgWindChart = new Chart(avgWindCtx, {
                        type: 'line',
                        data: {
                            labels: labels,
                            datasets: [{
                                label: 'Average Wind Speed',
                                data: avgWindData,
                                borderColor: 'blue',
                                fill: false
                            }]
                        },
                        options: {
                            scales: {
                                y: {
                                    beginAtZero: true
                                }
                            }
                        }
                    });

                    const gustCtx = document.getElementById('gustChart').getContext('2d');
                    const gustChart = new Chart(gustCtx, {
                        type: 'line',
                        data: {
                            labels: labels,
                            datasets: [{
                                label: 'Max Gust',
                                data: maxGustData,
                                borderColor: 'red',
                                fill: false
                            }]
                        },
                        options: {
                            scales: {
                                y: {
                                    beginAtZero: true
                                }
                            }
                        }
                    });

                    const dirCtx = document.getElementById('dirChart').getContext('2d');
                    const dirChart = new Chart(dirCtx, {
                        type: 'line',
                        data: {
                            labels: labels,
                            datasets: [{
                                label: 'Average Wind Direction',
                                data: dirData,
                                borderColor: 'green',
                                fill: false
                            }]
                        },
                        options: {
                            scales: {
                                y: {
                                    beginAtZero: true
                                }
                            }
                        }
                    });
                })
                .catch(error => {
                    console.error("Error fetching 24-hour trend data:", error);
                    document.getElementById('trend-display').innerHTML = "<p>Error loading data.</p>";
                });
        }

        fetchAndDisplayTrend();
    </script>
</body>
</html>